<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RiderSkill ‚Äî Accueil</title>
<link rel="icon" href="https://unavatar.io/twitch/riderskill" />
<meta name="theme-color" content="#0D0D0D" />
<style>
:root{
  --panel:#141414; --text:#EDEDED; --muted:#9aa0a6;
  --twitch:#9146FF; --kick:#53FC18; --ok:#22c55e; --ko:#ef4444;
}

/* Base */
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{
  min-height:100vh;color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
  /* FOND: overlay + 2 images (gaming clair + robot/IA), pas de fixed (compat mobile) */
  background-image:
    radial-gradient(ellipse at 50% 40%, rgba(255,255,255,.10), rgba(255,255,255,.05) 35%, rgba(0,0,0,.35) 65%, rgba(0,0,0,.55) 100%),
    url("https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=1920&auto=format&fit=crop"),
    url("https://images.unsplash.com/photo-1581091226825-c6a6c8f6fa54?q=80&w=1920&auto=format&fit=crop");
  background-size: cover, cover, cover;
  background-position: center 25%, center 35%, center 30%;
  background-repeat: no-repeat, no-repeat, no-repeat;
  background-color:#0f1014;
}
a{color:inherit;text-decoration:none}
.container{width:100%;max-width:1120px;margin:0 auto;padding:0 16px}

/* Topbar */
.topbar{position:sticky;top:0;z-index:1000;background:rgba(13,13,13,.82);backdrop-filter:saturate(160%) blur(8px);border-bottom:1px solid #1f1f1f}
.nav{display:flex;align-items:center;justify-content:space-between;gap:12px;min-height:56px}
.brand{display:flex;align-items:center;gap:10px;white-space:nowrap}
.brand-avatar{width:28px;height:28px;border-radius:6px;box-shadow:0 0 0 2px rgba(0,0,0,.35)}
#brandText{font-weight:800}
.status-wrap{display:inline-flex;align-items:center;gap:6px;margin-left:6px;white-space:nowrap}
#statusDot{
  width:12px;height:12px;border-radius:50%;display:inline-block;
  background:var(--ko); /* OFF par d√©faut */
  box-shadow:0 0 0 2px rgba(0,0,0,.4), 0 0 10px rgba(239,68,68,.35);
}
#statusLabel{font-weight:800;font-size:.85rem;letter-spacing:.5px;color:var(--ko)}

/* Boutons / logos */
.links{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
.btn{
  padding:8px 12px;background:rgba(26,26,26,.9);border:1px solid #2a2a2a;border-radius:10px;
  font-weight:700;display:inline-flex;align-items:center;gap:8px;
  transition:transform .18s,background .18s,border-color .18s
}
.btn:hover{transform:translateY(-1px);background:#1e1e1e;border-color:#3a3a3a}
.icon{width:18px;height:18px;display:block;transition:transform .18s,filter .18s}
.btn.social:hover .icon{transform:translateY(-1px) scale(1.06);filter:drop-shadow(0 0 6px rgba(255,255,255,.15))}

/* Hero / Cards */
.hero{display:grid;gap:16px;padding:20px 0}
.card{
  background:linear-gradient(180deg, rgba(20,20,20,.92), rgba(20,20,20,.88));
  border:1px solid #1f1f1f;border-radius:14px;padding:16px;
  box-shadow:0 6px 20px rgba(0,0,0,.28)
}
.title{margin:0 0 6px 0}
.subtitle{margin:0;color:var(--muted)}

/* Sections */
.section{padding:20px 0}
.panel{
  background:linear-gradient(180deg, rgba(20,20,20,.92), rgba(20,20,20,.88));
  border:1px solid #1f1f1f;border-radius:14px;padding:16px;
  box-shadow:0 10px 28px rgba(0,0,0,.35)
}

/* Live */
.live-wrap{display:grid;grid-template-columns:2fr 1fr;gap:10px}
.player,.chat{height:520px;border-radius:10px;border:1px solid #1f1f1f}
.chat{background:#0b0b0b}

/* Agenda */
.agenda-list{display:grid;gap:10px}
.ag-item{display:flex;align-items:center;justify-content:space-between;gap:10px;background:#121212;border:1px solid #222;border-radius:10px;padding:10px}
.ag-left{display:flex;flex-direction:column}
.ag-title{font-weight:800;margin:0}
.ag-meta{color:#9a9a9a;font-size:.9rem}
.badge{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:6px 10px;font-weight:800;letter-spacing:.3px}
.badge.live{background:#05260f;color:var(--ok);border:1px solid #115e2c}
.badge.soon{background:#1d1b09;color:#facc15;border:1px solid #8a6d0a}
.badge.off{background:#2a0b0b;color:var(--ko);border:1px solid #7a2020}

/* RADIO */
.radio{
  display:grid;gap:10px
}
.radio-wrap{
  display:flex;align-items:center;gap:12px;flex-wrap:wrap
}
.radio-btn{
  padding:10px 14px;border-radius:10px;border:1px solid #2a2a2a;background:#1b1b1b;
  font-weight:800;cursor:pointer;user-select:none;transition:transform .15s,background .15s,border-color .15s
}
.radio-btn:hover{transform:translateY(-1px);background:#202020;border-color:#3a3a3a}
.radio-title{margin:0}
.radio-meta{color:#9a9a9a;font-size:.9rem}

/* FAB CLIPS */
.fab-clips{
  position:fixed;right:18px;bottom:18px;z-index:9999;display:inline-flex;align-items:center;gap:10px;
  padding:12px 16px;border-radius:999px;background:linear-gradient(135deg,#9146FF 0%,#53FC18 100%);
  color:#0D0D0D;font-weight:900;letter-spacing:.5px;text-decoration:none;
  box-shadow:0 8px 24px rgba(0,0,0,.35);transition:transform .18s,box-shadow .18s
}
.fab-clips:hover{transform:translateY(-2px);box-shadow:0 12px 28px rgba(0,0,0,.45)}
.fab-emoji{font-size:20px}.fab-text{font-size:14px}

/* Footer */
footer{opacity:.9;padding:24px 0;text-align:center;color:var(--muted);text-shadow:0 1px 2px rgba(0,0,0,.35)}

/* Responsive */
@media (max-width:900px){ .live-wrap{grid-template-columns:1fr}.player,.chat{height:420px} }
@media (max-width:560px){ #statusLabel{display:none} }
@media (max-width:520px){ .fab-text{display:none} .fab-clips{padding:12px} }
@media (max-width:420px){ #brandText{display:none} }
</style>
</head>

<body>
<!-- TOPBAR -->
<div class="topbar">
  <div class="nav container">
    <a class="brand" href="/riderskill-site/index.html" title="Accueil">
      <img class="brand-avatar" src="https://unavatar.io/twitch/riderskill" alt="Logo RiderSkill">
      <span id="brandText">RiderSkill</span>
      <span class="status-wrap">
        <span id="statusDot" title="Hors-ligne (OFF)" aria-label="Hors-ligne (OFF)"></span>
        <span id="statusLabel">OFF</span>
      </span>
    </a>

    <div class="links">
      <a class="btn" href="/riderskill-site/index.html">Live</a>
      <a class="btn" href="/riderskill-site/clips.html">Clips</a>
      <a class="btn" href="/riderskill-site/alaune.html">√Ä la une</a>

      <!-- Logos officiels via Simple Icons (SVG) -->
      <a class="btn social" href="https://www.twitch.tv/riderskill" target="_blank" rel="noopener">
        <img class="icon" src="https://cdn.simpleicons.org/twitch/9146FF" alt="Twitch"> Twitch
      </a>
      <a class="btn social" href="https://kick.com/riderskill" target="_blank" rel="noopener">
        <img class="icon" src="https://cdn.simpleicons.org/kick/53FC18" alt="Kick"> Kick
      </a>
      <a class="btn social" href="https://www.youtube.com/@riderskill" target="_blank" rel="noopener">
        <img class="icon" src="https://cdn.simpleicons.org/youtube/FF0000" alt="YouTube"> YouTube
      </a>
      <a class="btn social" href="https://www.tiktok.com/@riderskill_twitch" target="_blank" rel="noopener">
        <img class="icon" src="https://cdn.simpleicons.org/tiktok/000000" alt="TikTok"> TikTok
      </a>
      <a class="btn social" href="https://x.com/riderskill" target="_blank" rel="noopener">
        <img class="icon" src="https://cdn.simpleicons.org/x/1DA1F2" alt="X"> X
      </a>
      <a class="btn social" href="https://discord.gg/2UWwhhyY" target="_blank" rel="noopener">
        <img class="icon" src="https://cdn.simpleicons.org/discord/5865F2" alt="Discord"> Discord
      </a>
    </div>
  </div>
</div>

<!-- HERO -->
<header class="hero container">
  <div class="card">
    <h1 class="title">Le show. Le game. <span style="color:var(--twitch)">La musique.</span></h1>
    <p class="subtitle">Streamer FR ‚Äî Rust ‚Ä¢ GTA ‚Ä¢ Sea of Thieves ‚Äî vibes musicales + commu active.</p>
  </div>
  <div class="card">
    <h2 class="title">Gameplay. Vibes. <span style="color:#53FC18">Clips √† gogo.</span></h2>
    <p class="subtitle">Moments forts, highlights et best-of. Tout est ici.</p>
  </div>
</header>

<!-- LIVE -->
<section class="section container" id="live">
  <div class="panel">
    <h2>Live int√©gr√©</h2>
    <div class="live-wrap">
      <div id="twitch-player" class="player"></div>
      <iframe id="twitch-chat" class="chat"
        src="https://www.twitch.tv/embed/riderskill/chat?parent=riderskill.github.io"
        title="Twitch chat" allowfullscreen></iframe>
    </div>
  </div>
</section>

<!-- AGENDA -->
<section class="section container" id="agenda">
  <div class="panel">
    <h2>Agenda</h2>
    <div id="agendaList" class="agenda-list"></div>
  </div>
</section>

<!-- RADIO -->
<section class="section container" id="radio">
  <div class="panel radio">
    <div>
      <h2 class="radio-title">Radio RiderSkill ‚Äî tes sons en continu</h2>
      <p class="radio-meta">Lecture en boucle, suivant auto, shuffle, reprise au rechargement. (Autoplay son = n√©cessite un clic selon le navigateur.)</p>
    </div>
    <div class="radio-wrap">
      <button id="btnPlay" class="radio-btn">‚ñ∂Ô∏è Lire</button>
      <button id="btnNext" class="radio-btn">‚è≠Ô∏è Suivant</button>
      <button id="btnPrev" class="radio-btn">‚èÆÔ∏è Pr√©c√©dent</button>
      <button id="btnShuffle" class="radio-btn">üîÄ Shuffle: OFF</button>
      <span id="nowPlaying" class="radio-meta">Aucun titre‚Ä¶</span>
    </div>
    <audio id="player" preload="none"></audio>
  </div>
</section>

<!-- BOUTON CLIPS -->
<a class="fab-clips" href="/riderskill-site/clips.html" aria-label="Aller aux clips">
  <span class="fab-emoji">üé¨</span><span class="fab-text">CLIPS !</span>
</a>

<!-- FOOTER -->
<footer class="container">¬© 2025 RiderSkill ‚Äî twitch.tv/riderskill ¬∑ kick.com/riderskill</footer>

<!-- SCRIPTS -->
<script src="https://player.twitch.tv/js/embed/v1.js"></script>
<script>
/* ===== Statut vert/rouge + libell√© ===== */
function setStatus(state){
  const dot=document.getElementById('statusDot');
  const label=document.getElementById('statusLabel');
  if(!dot||!label) return;
  if(state==='on'){
    dot.style.background='var(--ok)';
    dot.style.boxShadow='0 0 0 2px rgba(0,0,0,.4), 0 0 10px rgba(34,197,94,.45)';
    label.textContent='LIVE'; label.style.color='var(--ok)';
    dot.title='Live (ON)'; dot.setAttribute('aria-label','Live (ON)');
  }else{
    dot.style.background='var(--ko)';
    dot.style.boxShadow='0 0 0 2px rgba(0,0,0,.4), 0 0 10px rgba(239,68,68,.35)';
    label.textContent='OFF'; label.style.color='var(--ko)';
    dot.title='Hors-ligne (OFF)'; dot.setAttribute('aria-label','Hors-ligne (OFF)');
  }
}
setStatus('off');
(function(){
  const p=new URLSearchParams(location.search);
  const s=p.get('status')||p.get('on');
  if(s==='1'||s==='true'||s==='on') setStatus('on');
  if(s==='0'||s==='false'||s==='off') setStatus('off');
})();

/* ===== Twitch Player ===== */
(function(){
  const parentHosts=["riderskill.github.io","localhost","127.0.0.1"];
  const player=new Twitch.Player("twitch-player",{
    channel:"riderskill", width:"100%", height:"100%",
    autoplay:true, muted:true, parent:parentHosts
  });
  player.addEventListener(Twitch.Player.ONLINE, ()=>setStatus('on'));
  player.addEventListener(Twitch.Player.OFFLINE,()=>setStatus('off'));
})();

/* ===== AGENDA depuis planning.json ===== */
function fmtDate(d){return d.toLocaleDateString('fr-FR',{weekday:'short',day:'2-digit',month:'2-digit'})}
function fmtTime(d){return d.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'})}
function renderAgenda(items){
  const el=document.getElementById('agendaList'); if(!el) return;
  const now=new Date();
  const rows = (Array.isArray(items)?items:[]).slice()
    .sort((a,b)=>new Date(a.start)-new Date(b.start))
    .map(it=>{
      const s=new Date(it.start); const e=it.end?new Date(it.end):null;
      const live = s<=now && (!e || e>=now);
      const soon = s>now && (s-now)<=1000*60*60*6;
      const badgeClass = live?'live':(soon?'soon':'off');
      const badgeText  = live?'EN LIVE':(soon?'Bient√¥t':'Programm√©');
      const when = `${fmtDate(s)} ¬∑ ${fmtTime(s)}${e?(' ‚Üí '+fmtTime(e)):""}`;
      const meta = [when, it.platform||''].filter(Boolean).join(' ¬∑ ');
      const title = (it.title||'Live').replace(/</g,'&lt;');
      return `<div class="ag-item">
        <div class="ag-left">
          <h3 class="ag-title">${title}</h3>
          <div class="ag-meta">${meta}</div>
        </div>
        <span class="badge ${badgeClass}">${badgeText}</span>
      </div>`;
    }).join('');
  el.innerHTML = rows || '<div class="ag-item"><div class="ag-left"><div class="ag-meta">Aucun √©v√©nement planifi√©.</div></div><span class="badge off">OFF</span></div>';
}
fetch('/riderskill-site/planning.json',{cache:'no-store'})
  .then(r=>r.ok?r.json():[])
  .then(renderAgenda)
  .catch(()=>renderAgenda([]));

/* ===== RADIO (playlist depuis /music/radio.json) ===== */
const audio = document.getElementById('player');
const np    = document.getElementById('nowPlaying');
const bPlay = document.getElementById('btnPlay');
const bNext = document.getElementById('btnNext');
const bPrev = document.getElementById('btnPrev');
const bShuf = document.getElementById('btnShuffle');
let list=[], i=0, shuffle=false;

function load(i0){
  if(!list.length) return;
  i = (i0+list.length)%list.length;
  const t = list[i];
  audio.src = t.url;
  audio.title = t.title||'Track';
  np.textContent = `‚ñ∂Ô∏è ${t.title||'Track'} ‚Äî ${t.artist||''}`.trim();
  localStorage.setItem('rs_radio_index', String(i));
  localStorage.setItem('rs_radio_time', '0');
}
function play(){ audio.play().catch(()=>{ /* autoplay bloqu√© -> texte */
  np.textContent = 'Clique ‚ñ∂Ô∏è Lire pour d√©marrer la radio';
}); }
function next(){ load(i + (shuffle? Math.floor(Math.random()*list.length) || 1 : 1)); play(); }
function prev(){ load(i-1); play(); }

bPlay.addEventListener('click', ()=>{ if(audio.paused){ play(); bPlay.textContent='‚è∏Ô∏è Pause'; } else { audio.pause(); bPlay.textContent='‚ñ∂Ô∏è Lire'; }});
bNext.addEventListener('click', next);
bPrev.addEventListener('click', prev);
bShuf.addEventListener('click', ()=>{ shuffle=!shuffle; bShuf.textContent = 'üîÄ Shuffle: ' + (shuffle?'ON':'OFF'); });

audio.addEventListener('ended', next);
audio.addEventListener('timeupdate', ()=>{ localStorage.setItem('rs_radio_time', String(audio.currentTime|0)); });

fetch('/riderskill-site/music/radio.json',{cache:'no-store'})
  .then(r=>r.ok?r.json():[])
  .then(arr=>{
    list = Array.isArray(arr)?arr:[];
    if(!list.length){ np.textContent='Aucune piste dans la radio.'; return; }
    // reprise index/temps
    const idx = parseInt(localStorage.getItem('rs_radio_index')||'0',10);
    load(isNaN(idx)?0:idx);
    const t = parseFloat(localStorage.getItem('rs_radio_time')||'0');
    if(!isNaN(t) && t>0) audio.currentTime = t;
  })
  .catch(()=>{ np.textContent='Impossible de charger la radio.'; });
</script>
</body>
</html>
