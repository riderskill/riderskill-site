
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RiderSkill — Accueil</title>
  <link rel="icon" href="https://unavatar.io/twitch/riderskill" />
  <meta name="theme-color" content="#0D0D0D" />
  
  <style>
  :root{ --panel:#141414; --text:#EDEDED; --muted:#9a9a9a; --ok:#22c55e; --ko:#ef4444; --twitch:#9146FF; }
  *{box-sizing:border-box} html,body{margin:0;padding:0}
  body{
    min-height:100vh; color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
  }
  .bg-layer{
    position:fixed; inset:0; z-index:-1; pointer-events:none;
    background:
      radial-gradient(ellipse at 50% 40%, rgba(255,255,255,.10), rgba(255,255,255,.05) 35%, rgba(0,0,0,.35) 65%, rgba(0,0,0,.55) 100%),
      url("/riderskill-site/musique/fond.jpg") center/cover no-repeat fixed;
  }
  a{color:inherit;text-decoration:none}
  .container{width:100%;max-width:1100px;margin:0 auto;padding:0 16px}
  .topbar{position:sticky;top:0;z-index:999;background:rgba(13,13,13,.82);backdrop-filter:saturate(160%) blur(8px);border-bottom:1px solid #1f1f1f}
  .nav{display:flex;align-items:center;justify-content:space-between;gap:12px;min-height:56px}
  .brand{display:flex;align-items:center;gap:10px;white-space:nowrap}
  .brand-avatar{width:28px;height:28px;border-radius:6px}
  #brandText{font-weight:800}
  .status-wrap{display:inline-flex;align-items:center;gap:6px;margin-left:6px;white-space:nowrap}
  #statusDot{width:12px;height:12px;border-radius:50%;background:var(--ko)}
  #statusLabel{font-weight:800;font-size:.85rem;letter-spacing:.5px;color:var(--ko)}
  .links{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  .btn{padding:8px 12px;background:rgba(26,26,26,.9);border:1px solid #2a2a2a;border-radius:10px;font-weight:700;display:inline-flex;align-items:center;gap:8px}
  .hero{display:grid;gap:16px;padding:20px 0}
  .card{background:rgba(20,20,20,.9);border:1px solid #1f1f1f;border-radius:14px;padding:16px}
  .subtitle{margin:0;color:var(--muted)}
  .section{padding:20px 0}
  .panel{background:rgba(20,20,20,.9);border:1px solid #1f1f1f;border-radius:14px;padding:16px}
  .live-wrap{display:grid;grid-template-columns:2fr 1fr;gap:10px}
  .player,.chat{height:520px;border-radius:10px;border:1px solid #1f1f1f;background:#0b0b0b}
  @media (max-width:900px){ .live-wrap{grid-template-columns:1fr}.player,.chat{height:420px} }
  .agenda-list{display:grid;gap:10px}
  .ag-item{display:flex;align-items:center;justify-content:space-between;gap:10px;background:#121212;border:1px solid #222;border-radius:10px;padding:10px}
  .ag-left{display:flex;flex-direction:column}
  .ag-title{font-weight:800;margin:0}
  .ag-meta{color:#9a9a9a;font-size:.9rem}
  .badge{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:6px 10px;font-weight:800}
  .badge.live{background:#05260f;color:var(--ok);border:1px solid #115e2c}
  .badge.soon{background:#1d1b09;color:#facc15;border:1px solid #8a6d0a}
  .badge.off{background:#2a0b0b;color:var(--ko);border:1px solid #7a2020}
  #vods .vod{display:flex;justify-content:space-between;align-items:center;gap:10px;background:#121212;border:1px solid #222;border-radius:10px;padding:10px;margin:8px 0}
  #vods .title{font-weight:800}
  #vods .date{color:#9a9a9a;font-size:.9rem}
  footer{opacity:.9;padding:24px 0;text-align:center;color:var(--muted)}
  </style>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DK85CR5F7Z"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-DK85CR5F7Z');
  </script>
</head>
<body>
<div class="bg-layer"></div>

<!-- TOPBAR -->
<div class="topbar">
  <div class="nav container">
    <a class="brand" href="/riderskill-site/index.html">
      <img class="brand-avatar" src="https://unavatar.io/twitch/riderskill" alt="Logo RiderSkill">
      <span id="brandText">RiderSkill</span>
      <span class="status-wrap">
        <span id="statusDot"></span>
        <span id="statusLabel">OFF</span>
      </span>
    </a>
    <div class="links">
      <a class="btn" href="/riderskill-site/index.html">Live</a>
      <a class="btn" href="/riderskill-site/clips.html">Clips</a>
      <a class="btn" href="/riderskill-site/alaune.html">À la une</a>
    </div>
  </div>
</div>

<!-- HERO -->
<header class="hero container">
  <div class="card">
    <h1 class="title">Le show. Le game. <span style="color:var(--twitch)">La musique.</span></h1>
    <p class="subtitle">Streamer FR — Rust • GTA • Sea of Thieves.</p>
  </div>
</header>

<!-- LIVE -->
<section class="section container" id="live">
  <div class="panel">
    <h2>Live intégré</h2>
    <div class="live-wrap">
      <iframe
        class="player"
        src="https://player.twitch.tv/?channel=riderskill&parent=riderskill.github.io&muted=true&autoplay=true"
        allow="autoplay; fullscreen"
        allowfullscreen
        frameborder="0"
        title="Twitch Player"></iframe>

      <iframe
        class="chat"
        src="https://www.twitch.tv/embed/riderskill/chat?parent=riderskill.github.io"
        frameborder="0"
        title="Twitch Chat"></iframe>
    </div>
  </div>
</section>

<!-- AGENDA -->
<section class="section container" id="agenda">
  <div class="panel">
    <h2>Agenda</h2>
    <div id="agendaList" class="agenda-list"></div>
  </div>
</section>

<!-- VOD -->
<section class="section container" id="vod">
  <div class="panel">
    <h2>VOD récentes</h2>
    <div id="vods"></div>
  </div>
</section>

<footer class="container">© 2025 RiderSkill</footer>

<script>
/* sécurité basique */
const esc = s => String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");

/* Agenda */
function fmtDate(d){return d.toLocaleDateString('fr-FR',{weekday:'short',day:'2-digit',month:'2-digit'})}
function fmtTime(d){return d.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'})}
function renderAgenda(items){
  const el=document.getElementById('agendaList'); if(!el) return;
  const now=new Date();
  el.innerHTML = (Array.isArray(items)?items:[]).map(it=>{
    const s=new Date(it.start); const e=it.end?new Date(it.end):null;
    const live=s<=now && (!e||e>=now);
    const soon=s>now && (s-now)<=1000*60*60*6;
    const badge= live?'live':(soon?'soon':'off');
    const text= live?'EN LIVE':(soon?'Bientôt':'Programmé');
    return `<div class="ag-item"><div class="ag-left">
      <h3 class="ag-title">${esc(it.title||'Live')}</h3>
      <div class="ag-meta">${fmtDate(s)} · ${fmtTime(s)}${e?(' → '+fmtTime(e)):""} · ${esc(it.platform||'')}</div>
    </div><span class="badge ${badge}">${text}</span></div>`;
  }).join('') || '<div class="ag-item"><div class="ag-left"><div class="ag-meta">Aucun événement planifié.</div></div><span class="badge off">OFF</span></div>';
}
fetch('/riderskill-site/planning.json',{cache:'no-store'})
  .then(r=>r.ok?r.json():[])
  .then(renderAgenda)
  .catch(()=>{});

/* VOD */
const bust = Date.now();
fetch('/riderskill-site/vod.json?v='+bust,{cache:'no-store'})
  .then(r=>r.ok?r.json():[])
  .then(list=>{
    const el=document.getElementById('vods'); if(!el) return;
    el.innerHTML = (Array.isArray(list)?list:[]).map(v=>`
      <div class="vod">
        <div>
          <div class="title">${esc(v.title||'VOD')}</div>
          <div class="date">${v.date? new Date(v.date).toLocaleString('fr-FR') : ''}</div>
        </div>
        <a class="btn" href="${esc(v.url||'#')}" target="_blank" rel="noopener">Regarder</a>
      </div>
    `).join('') || '<div class="muted">Aucune VOD.</div>';
  })
  .catch(()=>{});
</script>
</body>
</html>
