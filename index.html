<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RiderSkill ‚Äî Streamer FR</title>
<link rel="icon" href="https://unavatar.io/twitch/riderskill" />
<meta name="theme-color" content="#0D0D0D" />

<style>
:root{
  --bg:#0f1014; --panel:#161616; --panel2:#1c1c1c; --line:#242424;
  --text:#EDEDED; --muted:#9aa0a6; --ok:#22c55e; --ko:#ef4444;
  --twitch:#9146FF; --kick:#53FC18;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{
  min-height:100vh;color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
  background:
    radial-gradient(ellipse at 50% 15%,
      rgba(255,255,255,.10) 0%,
      rgba(255,255,255,.05) 30%,
      rgba(0,0,0,.35) 65%,
      rgba(0,0,0,.60) 100%),
    url("https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=1920&auto=format&fit=crop") center/cover no-repeat fixed,
    var(--bg);
}
a{color:inherit;text-decoration:none}
.container{width:100%;max-width:1120px;margin:0 auto;padding:0 16px}
.section{padding:26px 0}
.muted{color:var(--muted)}
/* Topbar */
.topbar{position:sticky;top:0;z-index:1000;background:rgba(13,13,13,.86);
  backdrop-filter:saturate(160%) blur(8px);border-bottom:1px solid #1f1f1f}
.nav{display:flex;align-items:center;justify-content:space-between;gap:12px;min-height:64px}
.brand{display:flex;align-items:center;gap:10px;white-space:nowrap}
.brand-avatar{width:28px;height:28px;border-radius:6px;box-shadow:0 0 0 2px rgba(0,0,0,.35)}
#brandText{font-weight:900}
.status-wrap{display:inline-flex;align-items:center;gap:8px;margin-left:6px}
#statusDot{width:12px;height:12px;border-radius:50%;background:var(--ko);
  box-shadow:0 0 0 2px rgba(0,0,0,.45),0 0 10px rgba(239,68,68,.35)}
#statusLabel{font-weight:900;letter-spacing:.5px;color:var(--ko)}
.links{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
.btn{padding:10px 14px;background:rgba(26,26,26,.92);border:1px solid #2a2a2a;border-radius:14px;
  font-weight:800;display:inline-flex;align-items:center;gap:8px;transition:transform .18s,background .18s,border-color .18s,box-shadow .18s}
.btn:hover{transform:translateY(-1px);background:#202020;border-color:#3a3a3a;box-shadow:0 8px 22px rgba(0,0,0,.28)}
/* Hero / Cards */
.hero{display:grid;gap:18px;padding:26px 0}
.card{background:linear-gradient(180deg, rgba(22,22,22,.94), rgba(22,22,22,.90));
  border:1px solid #1f1f1f;border-radius:22px;padding:22px;box-shadow:0 12px 30px rgba(0,0,0,.38)}
.title{margin:0 0 6px 0;font-size:2.4rem;line-height:1.2;font-weight:900}
.subtitle{margin:0;color:var(--muted);font-size:1.1rem}
/* Live */
.panel{background:linear-gradient(180deg, rgba(24,24,24,.94), rgba(24,24,24,.90));
  border:1px solid #1f1f1f;border-radius:22px;padding:22px;box-shadow:0 12px 30px rgba(0,0,0,.38)}
.live-wrap{display:grid;grid-template-columns:2fr 1fr;gap:14px}
.player,.chat{height:540px;border-radius:16px;border:1px solid #1f1f1f;background:#0b0b0b}
@media (max-width:900px){ .live-wrap{grid-template-columns:1fr}.player,.chat{height:420px} }
/* Agenda */
.agenda-list{display:grid;gap:12px}
.ag-item{display:flex;align-items:center;justify-content:space-between;gap:12px;background:#131313;border:1px solid #222;border-radius:14px;padding:12px 14px}
.ag-left{display:flex;flex-direction:column}
.ag-title{margin:0;font-weight:900}
.ag-meta{color:var(--muted);font-size:.95rem}
.badge{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:7px 12px;font-weight:900;letter-spacing:.3px}
.badge.live{background:#05260f;color:var(--ok);border:1px solid #135f2e}
.badge.soon{background:#1d1b09;color:#facc15;border:1px solid #8a6d0a}
.badge.off{background:#2a0b0b;color:var(--ko);border:1px solid #7a2020}
/* VOD */
.vods{display:grid;gap:12px}
.vod{display:flex;align-items:center;justify-content:space-between;gap:10px;background:#121212;border:1px solid #222;border-radius:14px;padding:12px}
.vod .meta{color:var(--muted);font-size:.9rem}
/* Radio */
.radio{display:grid;gap:10px}
.radio-wrap{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.radio-btn{padding:10px 14px;border-radius:12px;border:1px solid #2a2a2a;background:#1b1b1b;font-weight:900;cursor:pointer;transition:transform .15s,background .15s,border-color .15s}
.radio-btn:hover{transform:translateY(-1px);background:#202020;border-color:#3a3a3a}
.radio-meta{color:var(--muted);font-size:.95rem}
/* FAB */
.fab-clips{position:fixed;right:18px;bottom:18px;z-index:9999;display:inline-flex;align-items:center;gap:10px;padding:12px 16px;border-radius:999px;
  background:linear-gradient(135deg,#9146FF 0%,#53FC18 100%);color:#0D0D0D;font-weight:900;letter-spacing:.5px;text-decoration:none;
  box-shadow:0 8px 24px rgba(0,0,0,.35);transition:transform .18s,box-shadow .18s}
.fab-clips:hover{transform:translateY(-2px);box-shadow:0 12px 28px rgba(0,0,0,.45)}
.fab-emoji{font-size:20px}.fab-text{font-size:14px}
@media (max-width:520px){ .fab-text{display:none} .fab-clips{padding:12px} }
footer{opacity:.9;padding:28px 0;text-align:center;color:var(--muted)}
</style>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DK85CR5F7Z"></script>
<script>
  window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}
  gtag('js', new Date()); gtag('config','G-DK85CR5F7Z');
</script>

<script src="https://player.twitch.tv/js/embed/v1.js"></script>
</head>
<body>
<div class="topbar">
  <div class="nav container">
    <a class="brand" href="./index.html" title="Accueil">
      <img class="brand-avatar" src="https://unavatar.io/twitch/riderskill" alt="Logo RiderSkill">
      <span id="brandText">RiderSkill</span>
      <span class="status-wrap">
        <span id="statusDot" title="Hors-ligne (OFF)" aria-label="Hors-ligne (OFF)"></span>
        <span id="statusLabel">OFF</span>
      </span>
    </a>
    <div class="links">
      <a class="btn" href="./index.html">Live</a>
      <a class="btn" href="./clips.html">Clips</a>
      <a class="btn" href="./alaune.html">√Ä la une</a>
      <a class="btn" href="https://www.twitch.tv/riderskill" target="_blank" rel="noopener">Twitch</a>
      <a class="btn" href="https://kick.com/riderskill" target="_blank" rel="noopener">Kick</a>
      <a class="btn" href="https://www.youtube.com/@riderskill" target="_blank" rel="noopener">YouTube</a>
      <a class="btn" href="https://www.tiktok.com/@riderskill_twitch" target="_blank" rel="noopener">TikTok</a>
      <a class="btn" href="https://x.com/riderskill" target="_blank" rel="noopener">X</a>
      <a class="btn" href="https://discord.gg/nbAZ28Z6jH" target="_blank" rel="noopener">Discord</a>
    </div>
  </div>
</div>

<header class="hero container">
  <div class="card">
    <h1 class="title">Le show. Le game. <span style="color:var(--twitch)">La musique.</span></h1>
    <p class="subtitle">Streamer FR ‚Äî Rust ‚Ä¢ GTA ‚Ä¢ Sea of Thieves ‚Äî vibes musicales + commu active.</p>
  </div>
  <div class="card">
    <h2 class="title" style="font-size:1.4rem;margin:0">Gameplay. Vibes. <span style="color:#53FC18">Clips √† gogo.</span></h2>
    <p class="subtitle">Moments forts, highlights et best-of. Tout est ici.</p>
  </div>
</header>

<section class="section container" id="live">
  <div class="panel">
    <h2>Live int√©gr√©</h2>
    <div class="live-wrap">
      <div id="twitch-player" class="player" title="Twitch player"></div>
      <iframe id="twitch-chat" class="chat" title="Twitch chat" allowfullscreen></iframe>
    </div>
  </div>
</section>

<section class="section container" id="agenda">
  <div class="panel">
    <h2>Agenda</h2>
    <div id="agendaList" class="agenda-list"></div>
    <div id="agendaError" class="muted" style="display:none;color:#ef4444;font-weight:800"></div>
  </div>
</section>

<section class="section container" id="radio">
  <div class="panel radio">
    <div>
      <h2 class="title" style="font-size:1.4rem;margin:0">Radio RiderSkill ‚Äî tes sons en continu</h2>
      <p class="radio-meta">Clique ‚ñ∂Ô∏è pour d√©marrer (bloqu√© par les navigateurs sans interaction).</p>
    </div>
    <div class="radio-wrap">
      <button id="btnPlay" class="radio-btn">‚ñ∂Ô∏è Lire</button>
      <button id="btnNext" class="radio-btn">‚è≠Ô∏è Suivant</button>
      <button id="btnPrev" class="radio-btn">‚èÆÔ∏è Pr√©c√©dent</button>
      <button id="btnShuffle" class="radio-btn">üîÄ Shuffle: OFF</button>
      <span id="nowPlaying" class="radio-meta">Aucun titre‚Ä¶</span>
    </div>
    <audio id="player" preload="none"></audio>
  </div>
</section>

<section class="section container" id="vod">
  <div class="panel">
    <h2>VOD r√©centes</h2>
    <div id="vods" class="vods"></div>
  </div>
</section>

<a class="fab-clips" href="https://www.twitch.tv/riderskill/videos?featured=true&filter=clips&range=all" target="_blank" rel="noopener" aria-label="Clips Twitch">
  <span class="fab-emoji">üé¨</span><span class="fab-text">CLIPS !</span>
</a>

<footer class="container">¬© 2025 RiderSkill ‚Äî twitch.tv/riderskill ¬∑ kick.com/riderskill</footer>

<script>
/* Statut LIVE/OFF */
function setStatus(state){
  const dot=document.getElementById('statusDot'); const label=document.getElementById('statusLabel');
  if(!dot||!label) return;
  if(state==='on'){
    dot.style.background='var(--ok)';
    dot.style.boxShadow='0 0 0 2px rgba(0,0,0,.4), 0 0 10px rgba(34,197,94,.45)';
    label.textContent='LIVE'; label.style.color='var(--ok)'; dot.title='Live (ON)';
  } else {
    dot.style.background='var(--ko)';
    dot.style.boxShadow='0 0 0 2px rgba(0,0,0,.4), 0 0 10px rgba(239,68,68,.35)';
    label.textContent='OFF'; label.style.color='var(--ko)'; dot.title='Hors-ligne (OFF)';
  }
}
setStatus('off');
(function(){ const p=new URLSearchParams(location.search); const s=p.get('status')||p.get('on');
  if(s==='1'||s==='true'||s==='on') setStatus('on'); if(s==='0'||s==='false'||s==='off') setStatus('off'); })();

/* Twitch Player + Chat parent dynamique */
(function(){
  const parentHosts=[location.hostname,"riderskill.github.io","localhost","127.0.0.1"];
  const player=new Twitch.Player("twitch-player",{channel:"riderskill",width:"100%",height:"100%",autoplay:true,muted:true,parent:parentHosts});
  player.addEventListener(Twitch.Player.ONLINE,()=>setStatus('on'));
  player.addEventListener(Twitch.Player.OFFLINE,()=>setStatus('off'));
  // Chat
  document.getElementById('twitch-chat').src =
    `https://www.twitch.tv/embed/riderskill/chat?parent=${encodeURIComponent(location.hostname)}`;
})();

/* Agenda (chemin RELATIF) */
function fmtDate(d){return d.toLocaleDateString('fr-FR',{weekday:'short',day:'2-digit',month:'2-digit'})}
function fmtTime(d){return d.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'})}
function renderAgenda(items){
  const el=document.getElementById('agendaList'); const err=document.getElementById('agendaError');
  if(!el) return;
  const now=new Date();
  if(!Array.isArray(items)){ el.innerHTML=''; if(err){err.style.display='block'; err.textContent='Agenda: format invalide (planning.json)'; } return; }
  const rows=items.slice().sort((a,b)=>new Date(a.start)-new Date(b.start)).map(it=>{
    const s=new Date(it.start); const e=it.end?new Date(it.end):null;
    const live=s<=now && (!e||e>=now); const soon=s>now && (s-now)<=1000*60*60*6;
    const badgeClass=live?'live':(soon?'soon':'off'); const badgeText=live?'EN LIVE':(soon?'Bient√¥t':'Programm√©');
    const when=`${fmtDate(s)} ¬∑ ${fmtTime(s)}${e?(' ‚Üí '+fmtTime(e)):""}`; const meta=[when,it.platform||''].filter(Boolean).join(' ¬∑ ');
    const title=(it.title||'Live').replace(/</g,'&lt;');
    return `<div class="ag-item"><div class="ag-left"><h3 class="ag-title">${title}</h3><div class="ag-meta">${meta}</div></div><span class="badge ${badgeClass}">${badgeText}</span></div>`;
  }).join('');
  if(err) err.style.display='none';
  el.innerHTML = rows || '<div class="ag-item"><div class="ag-left"><div class="ag-meta">Aucun √©v√©nement planifi√©.</div></div><span class="badge off">OFF</span></div>';
}
const bust=Date.now();
fetch('./planning.json?v='+bust,{cache:'no-store'})
  .then(r=>{ if(!r.ok) throw new Error('HTTP '+r.status); return r.json(); })
  .then(renderAgenda)
  .catch(e=>{ const err=document.getElementById('agendaError'); if(err){ err.style.display='block'; err.textContent='Agenda introuvable: assure-toi que ./planning.json existe. ('+e.message+')'; }});

/* Radio (chemin RELATIF ./music/radio.json) */
const audio=document.getElementById('player'), np=document.getElementById('nowPlaying');
const bPlay=document.getElementById('btnPlay'), bNext=document.getElementById('btnNext'), bPrev=document.getElementById('btnPrev'), bShuf=document.getElementById('btnShuffle');
let list=[], i=0, shuffle=false;
function load(i0){ if(!list.length) return; i=(i0+list.length)%list.length; const t=list[i]; audio.src=t.url; audio.title=t.title||'Track'; np.textContent=`‚ñ∂Ô∏è ${t.title||'Track'}${t.artist?(' ‚Äî '+t.artist):''}`; localStorage.setItem('rs_radio_index', String(i)); localStorage.setItem('rs_radio_time','0'); }
function play(){ audio.play().catch(()=>{ np.textContent='Clique ‚ñ∂Ô∏è Lire pour d√©marrer la radio'; }); }
function next(){ load(i + (shuffle? Math.floor(Math.random()*list.length) || 1 : 1)); play(); }
function prev(){ load(i-1); play(); }
bPlay.addEventListener('click', ()=>{ if(audio.paused){ play(); bPlay.textContent='‚è∏Ô∏è Pause'; } else { audio.pause(); bPlay.textContent='‚ñ∂Ô∏è Lire'; }});
bNext.addEventListener('click', next); bPrev.addEventListener('click', prev);
bShuf.addEventListener('click', ()=>{ shuffle=!shuffle; bShuf.textContent='üîÄ Shuffle: '+(shuffle?'ON':'OFF'); });
audio.addEventListener('ended', next); audio.addEventListener('timeupdate', ()=>{ localStorage.setItem('rs_radio_time', String(audio.currentTime|0)); });
fetch('./music/radio.json?v='+bust,{cache:'no-store'})
 .then(r=>r.ok?r.json():[])
 .then(arr=>{
   list=Array.isArray(arr)?arr:[]; if(!list.length){ np.textContent='Aucune piste dans la radio.'; return; }
   const idx=parseInt(localStorage.getItem('rs_radio_index')||'0',10); load(isNaN(idx)?0:idx);
   const t=parseFloat(localStorage.getItem('rs_radio_time')||'0'); if(!isNaN(t) && t>0) audio.currentTime=t;
 }).catch(()=>{ np.textContent='Impossible de charger la radio.'; });

/* VOD (chemin RELATIF ./vod.json) */
function renderVod(list){
  const el=document.getElementById('vods');
  if(!el) return;
  if(!Array.isArray(list)||!list.length){ el.innerHTML='<div class="muted">Aucune VOD.</div>'; return; }
  el.innerHTML=list.slice(0,10).map(v=>{
    const t=(v.title||'VOD').replace(/</g,'&lt;'); const d=v.date?new Date(v.date):null;
    const meta=d?d.toLocaleString('fr-FR'):(v.platform||'');
    return `<div class="vod"><div><div class="title">${t}</div><div class="meta">${meta}</div></div><a class="btn" href="${v.url}" target="_blank" rel="noopener">Voir</a></div>`;
  }).join('');
}
fetch('./vod.json?v='+bust,{cache:'no-store'}).then(r=>r.ok?r.json():[]).then(renderVod).catch(()=>{});
</script>
</body>
</html>
